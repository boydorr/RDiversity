---
title: "Phylogenetic Diversity"
author: "Sonia Mitchell"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{rdiversity}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  \usepackage{rdiversity}
---

# Introduction to rdiversity package

This is a minimal example of the `rdiversity` package. 

```{r load_package, results='hide'} 
library(rdiversity)
```


## Calculate diversity

```{r}
# Species counts
population <- data.frame(subcommunityA = sample(1:50, 5, replace = TRUE),
                       subcommunityB = sample(1:50, 5, replace = TRUE))
row.names(population) <- c('cows', 'sheep', 'ducks', 'foxes', 'bears')
population

# Coerse object into a supercommunity
data <- as.supercommunity(population)
data

# Calculate diversity
results <- subcommunity.alpha.bar(data, 0:2)
results
class(results)
attributes(results)
plot(results)
rdplot(results)
```



## Calculate phylogenetic diversity

First we should create a phylogeny to look at. 

```{r create_tree} 
# Simulate and plot phylogeny
tree <- ape::rtree(n = 10)
plot(tree, edge.width = 2)
```

This object is of class `phylo` and has the following structure:

```{r examine_phylo}
str(tree)
```

We can extract the tip labels (or any other structural element, see `?phylo`) 
like this:

```{r phylo_element}
tree$tip.label
```

The package `rdiversity`, requires that a phylogeny is input as an object of 
class `rdphylo`. We can convert objects of class `phylo` into those of class 
`rdphylo`:

```{r set_parameters, results='hide'} 
new.tree <- as.rdphylo(tree)
```

This object has an extended structure:

```{r examine_rdphylo}
str(new.tree)
```

We can extract the historic species labels (or any other structural element, 
see `?diversity`) like this:

```{r rdphylo_element} 
new.tree@hs.name
```

as

```{r define_supercommunity, results='hide'}
pds.abundance <- data.frame(A = sample(1:50, 10, replace = TRUE),
                       B = sample(1:50, 10, replace = TRUE))

data <- as.supercommunity(new.tree)
```

asd

```{r calculate_diversity}
subcommunity.alpha.bar(data, 0:2)
results <- diversity(subcommunity.alpha.bar, data, 0:2)

```